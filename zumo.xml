<?xml version="1.0" encoding="UTF-8"?>
<table xmlns="http://query.yahooapis.com/v1/schema/table.xsd">
  <meta>
    <author>Steve Sanderson</author>
    <sampleQuery>SELECT * FROM zumo;</sampleQuery>
    <documentationURL></documentationURL>
  </meta>
  <bindings>
    <select itemPath="" produces="JSON">
      <inputs>  
            <key id="appUrl" type="xs:string" paramType="variable" required="true" />  
            <key id="tableName" type="xs:string" paramType="variable" required="true" />  
            <key id="operation" type="xs:string" paramType="variable" required="true" />
            <key id="id" type="xs:number" paramType="variable" required="false" />
            <key id="payload" type="xs:string" paramType="variable" required="false" />
      </inputs>      
      <execute><![CDATA[
         if (appUrl.charAt(appUrl.length - 1) !== '/') {
             appUrl += '/';
         }
         
         var url = appUrl + "tables/" + tableName + (id ? "/" + id : ""),
             myRequest = y.rest(url),
             zumoResponse,
             responseData;
         
         switch (operation) {
             case "read": 
                zumoResponse = myRequest.get();
                responseData = y.parseJson(zumoResponse.response);
                break;
             case "insert": zumoResponse = myRequest.post(payload); break;
             case "update": zumoResponse = myRequest.post(payload); break;
             case "delete": zumoResponse = myRequest.del(); break;
         }
         
         response.object = {
             statusCode: zumoResponse.status,
             data: responseData,
             info: String(myRequest.patch)
         };
      ]]></execute>
    </select>
  </bindings>
</table>